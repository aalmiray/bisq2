buildscript {
    repositories {
        maven { url 'https://plugins.gradle.org/m2/' }
    }
    dependencies {
        classpath 'gradle.plugin.org.hidetake:gradle-swagger-generator-plugin:2.18.2'
        classpath 'org.openjfx:javafx-plugin:0.0.10'
    }
}

configure(project(':api')) {
    apply plugin: 'java-library'

    repositories {
        mavenCentral()
    }

    dependencies {
        api 'io.reactivex.rxjava3:rxjava:3.0.13'
    }
}

configure(project(':core')) {
    apply plugin: 'java'

    repositories {
        mavenCentral()
    }

    dependencies {
        implementation project(':api')
    }
}

configure(project(':http-service')) {
    apply plugin: 'java'

    repositories {
        mavenCentral()
    }

    dependencies {
        implementation project(':api')
        implementation project(':core')
        implementation 'com.sparkjava:spark-core:2.9.3'
    }
}

configure(project(':http-client')) {
    apply plugin: 'java-library'

    repositories {
        mavenCentral()
    }

    dependencies {
        api project(':api')
        implementation 'com.squareup.okhttp3:okhttp:4.9.1'
    }
}

configure(project(':daemon')) {
    apply plugin: 'application'

    repositories {
        mavenCentral()
    }

    dependencies {
        implementation project(':api')
        implementation project(':core')
        implementation project(':http-service')
    }

    application {
        mainClass = 'bisq.app.daemon.BisqDaemon'
    }

    build.dependsOn installDist
}

configure(project(':cli')) {
    apply plugin: 'application'

    repositories {
        mavenCentral()
    }

    dependencies {
        implementation project(':http-client')
        testImplementation project(':daemon')
        testImplementation 'org.junit.jupiter:junit-jupiter-api:5.7.1'
        testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine'
    }

    application {
        mainClass = 'bisq.app.cli.BisqCli'
    }

    tasks.named('test') {
        useJUnitPlatform()
    }

    build.dependsOn installDist
}

configure(project(':desktop')) {
    apply plugin: 'application'
    apply plugin: 'org.openjfx.javafxplugin'

    repositories {
        mavenCentral()
    }

    javafx {
        //version = '17-ea+11'
        sdk = '/Users/cbeams/lab/javafx-sdk/javafx-sdk-17/'
        modules = ['javafx.controls']
    }

    application {
        mainClass = 'bisq.app.desktop.BisqDesktop'
    }

    dependencies {
        implementation project(':http-client')
    }

    startScripts {
        defaultJvmOpts = [
                '--module-path=/Users/cbeams/lab/javafx-sdk/javafx-sdk-17/lib',
                '--add-modules=javafx.controls'
        ]
    }

    build.dependsOn installDist
}

configure(project(':swagger')) {
    apply plugin: 'org.hidetake.swagger.generator'

    repositories {
        mavenCentral()
    }

    dependencies {
        //swaggerCodegen 'io.swagger:swagger-codegen-cli:2.4.2'             // Swagger Codegen V2
        //swaggerCodegen 'io.swagger.codegen.v3:swagger-codegen-cli:3.0.5'  // or Swagger Codegen V3
        swaggerCodegen 'org.openapitools:openapi-generator-cli:3.3.4'     // or OpenAPI Generator
        swaggerUI 'org.webjars:swagger-ui:3.10.0'
    }

    swaggerSources {
        petstore {
            inputFile = file('petstore.yaml')
            code {
                language = 'spring'
            }
        }
    }
}
